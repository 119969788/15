# æœåŠ¡å™¨éƒ¨ç½²è¯¦ç»†æ•™ç¨‹

æœ¬æ•™ç¨‹å°†æŒ‡å¯¼ä½ åœ¨LinuxæœåŠ¡å™¨ä¸Šéƒ¨ç½²15åˆ†é’Ÿå¸‚åœºå¥—åˆ©ç¨‹åºã€‚

## ç›®å½•

- [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
- [æ­¥éª¤1: æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡](#æ­¥éª¤1-æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡)
- [æ­¥éª¤2: å®‰è£…Node.js](#æ­¥éª¤2-å®‰è£…nodejs)
- [æ­¥éª¤3: å…‹éš†é¡¹ç›®](#æ­¥éª¤3-å…‹éš†é¡¹ç›®)
- [æ­¥éª¤4: å®‰è£…ä¾èµ–](#æ­¥éª¤4-å®‰è£…ä¾èµ–)
- [æ­¥éª¤5: é…ç½®ç¯å¢ƒå˜é‡](#æ­¥éª¤5-é…ç½®ç¯å¢ƒå˜é‡)
- [æ­¥éª¤6: æµ‹è¯•è¿è¡Œ](#æ­¥éª¤6-æµ‹è¯•è¿è¡Œ)
- [æ­¥éª¤7: ä½¿ç”¨PM2å®ˆæŠ¤è¿›ç¨‹](#æ­¥éª¤7-ä½¿ç”¨pm2å®ˆæŠ¤è¿›ç¨‹)
- [æ­¥éª¤8: è®¾ç½®å¼€æœºè‡ªå¯](#æ­¥éª¤8-è®¾ç½®å¼€æœºè‡ªå¯)
- [æ­¥éª¤9: æ—¥å¿—ç®¡ç†](#æ­¥éª¤9-æ—¥å¿—ç®¡ç†)
- [æ­¥éª¤10: ç›‘æ§å’Œç»´æŠ¤](#æ­¥éª¤10-ç›‘æ§å’Œç»´æŠ¤)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## å‰ç½®è¦æ±‚

- LinuxæœåŠ¡å™¨ï¼ˆUbuntu 20.04+ / CentOS 7+ / Debian 10+ï¼‰
- æœåŠ¡å™¨æœ‰rootæˆ–sudoæƒé™
- è‡³å°‘2GBå†…å­˜
- ç¨³å®šçš„ç½‘ç»œè¿æ¥
- GitHubè´¦æˆ·ï¼ˆç”¨äºå…‹éš†ä»“åº“ï¼‰

---

## æ­¥éª¤1: æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡

### 1.1 æ›´æ–°ç³»ç»ŸåŒ…

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt upgrade -y
```

**CentOS/RHEL:**
```bash
sudo yum update -y
# æˆ– CentOS 8+
sudo dnf update -y
```

### 1.2 å®‰è£…åŸºç¡€å·¥å…·

**Ubuntu/Debian:**
```bash
sudo apt install -y curl wget git build-essential
```

**CentOS/RHEL:**
```bash
sudo yum install -y curl wget git gcc gcc-c++ make
# æˆ– CentOS 8+
sudo dnf install -y curl wget git gcc gcc-c++ make
```

### 1.3 åˆ›å»ºä¸“ç”¨ç”¨æˆ·ï¼ˆæ¨èï¼‰

ä¸ºäº†å®‰å…¨ï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ªä¸“ç”¨ç”¨æˆ·æ¥è¿è¡Œç¨‹åºï¼š

```bash
# åˆ›å»ºç”¨æˆ·
sudo useradd -m -s /bin/bash trader

# åˆ‡æ¢åˆ°æ–°ç”¨æˆ·
sudo su - trader
```

---

## æ­¥éª¤2: å®‰è£…Node.js

### 2.1 ä½¿ç”¨NodeSourceå®‰è£…ï¼ˆæ¨èï¼‰

**å®‰è£…Node.js 20.x LTSç‰ˆæœ¬ï¼š**

```bash
# ä¸‹è½½å¹¶è¿è¡Œå®‰è£…è„šæœ¬
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -

# Ubuntu/Debian
sudo apt install -y nodejs

# CentOS/RHEL
sudo yum install -y nodejs
```

### 2.2 éªŒè¯å®‰è£…

```bash
node --version
npm --version
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
v20.10.0
10.2.3
```

### 2.3 å®‰è£…pnpmï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰

```bash
npm install -g pnpm
```

éªŒè¯ï¼š
```bash
pnpm --version
```

---

## æ­¥éª¤3: å…‹éš†é¡¹ç›®

### 3.1 å…‹éš†ä»“åº“

```bash
# å¦‚æœä½¿ç”¨ä¸“ç”¨ç”¨æˆ·ï¼Œç¡®ä¿åœ¨traderç”¨æˆ·ä¸‹
cd ~
git clone https://github.com/119969788/15.git
cd 15
```

### 3.2 éªŒè¯æ–‡ä»¶

```bash
ls -la
```

åº”è¯¥çœ‹åˆ°é¡¹ç›®æ–‡ä»¶ï¼š
```
.gitignore
package.json
README.md
src/
scripts/
...
```

---

## æ­¥éª¤4: å®‰è£…ä¾èµ–

### 4.1 ä½¿ç”¨npmå®‰è£…

```bash
npm install
```

### 4.2 æˆ–ä½¿ç”¨pnpmå®‰è£…ï¼ˆæ›´å¿«ï¼‰

```bash
pnpm install
```

### 4.3 éªŒè¯å®‰è£…

```bash
ls node_modules
```

åº”è¯¥çœ‹åˆ°ä¾èµ–åŒ…å·²å®‰è£…ã€‚

---

## æ­¥éª¤5: é…ç½®ç¯å¢ƒå˜é‡

### 5.1 åˆ›å»º.envæ–‡ä»¶

```bash
cd ~/15
nano .env
```

### 5.2 å¡«å…¥é…ç½®

åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼ˆæŒ‰å®é™…æƒ…å†µä¿®æ”¹ï¼‰ï¼š

```env
# ç§é’¥ï¼ˆå¿…éœ€ï¼‰- ä½ çš„é’±åŒ…ç§é’¥
PRIVATE_KEY=0xä½ çš„ç§é’¥

# ç½‘ç»œï¼ˆå¯é€‰ï¼Œé»˜è®¤polygonï¼‰
NETWORK=polygon

# æ ‡çš„èµ„äº§ï¼ˆå¯é€‰ï¼Œé»˜è®¤ETHï¼‰
UNDERLYING=ETH

# æœ€å¤§æŒä»“æ•°é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤100ï¼‰
MAX_POSITION_SIZE=100
```

### 5.3 ä¿å­˜å¹¶é€€å‡º

- æŒ‰ `Ctrl + X`
- æŒ‰ `Y` ç¡®è®¤
- æŒ‰ `Enter` ä¿å­˜

### 5.4 è®¾ç½®æ–‡ä»¶æƒé™ï¼ˆé‡è¦ï¼ï¼‰

```bash
# è®¾ç½®åªæœ‰å½“å‰ç”¨æˆ·å¯è¯»å†™
chmod 600 .env

# éªŒè¯æƒé™
ls -l .env
```

åº”è¯¥æ˜¾ç¤ºï¼š
```
-rw------- 1 trader trader ... .env
```

---

## æ­¥éª¤6: æµ‹è¯•è¿è¡Œ

### 6.1 ç¼–è¯‘TypeScript

```bash
npm run build
```

### 6.2 æµ‹è¯•è¿è¡Œï¼ˆå‰å°ï¼‰

```bash
npm run dev
```

å¦‚æœçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼Œè¯´æ˜è¿è¡Œæ­£å¸¸ï¼š
```
ğŸš€ 15åˆ†é’Ÿå¸‚åœºå¥—åˆ©ç¨‹åºå¯åŠ¨
é…ç½®: ä¹°å…¥ä»·=0.8, å–å‡ºä»·=0.9
æ ‡çš„: ETH, æ—¶é•¿: 15m
```

### 6.3 åœæ­¢æµ‹è¯•

æŒ‰ `Ctrl + C` åœæ­¢ç¨‹åºã€‚

---

## æ­¥éª¤7: ä½¿ç”¨PM2å®ˆæŠ¤è¿›ç¨‹

PM2æ˜¯ä¸€ä¸ªNode.jsè¿›ç¨‹ç®¡ç†å™¨ï¼Œå¯ä»¥ä¿æŒç¨‹åºåœ¨åå°è¿è¡Œã€‚

### 7.1 å®‰è£…PM2

```bash
npm install -g pm2
```

### 7.2 åˆ›å»ºPM2é…ç½®æ–‡ä»¶

```bash
cd ~/15
nano ecosystem.config.js
```

è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š

```javascript
module.exports = {
  apps: [{
    name: '15min-arbitrage',
    script: 'dist/index.js',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '500M',
    env: {
      NODE_ENV: 'production'
    },
    error_file: './logs/pm2-error.log',
    out_file: './logs/pm2-out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
    merge_logs: true
  }]
};
```

ä¿å­˜å¹¶é€€å‡ºã€‚

### 7.3 åˆ›å»ºæ—¥å¿—ç›®å½•

```bash
mkdir -p logs
```

### 7.4 å¯åŠ¨ç¨‹åº

```bash
# å…ˆç¼–è¯‘
npm run build

# ä½¿ç”¨PM2å¯åŠ¨
pm2 start ecosystem.config.js
```

### 7.5 æŸ¥çœ‹çŠ¶æ€

```bash
pm2 status
```

åº”è¯¥çœ‹åˆ°ç¨‹åºæ­£åœ¨è¿è¡Œï¼š
```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”‚ name                â”‚ status  â”‚ restart â”‚ uptime   â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0   â”‚ 15min-arbitrage     â”‚ online  â”‚ 0       â”‚ 5s       â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.6 å¸¸ç”¨PM2å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
pm2 logs 15min-arbitrage

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show 15min-arbitrage

# é‡å¯ç¨‹åº
pm2 restart 15min-arbitrage

# åœæ­¢ç¨‹åº
pm2 stop 15min-arbitrage

# åˆ é™¤ç¨‹åº
pm2 delete 15min-arbitrage

# æŸ¥çœ‹ç›‘æ§é¢æ¿
pm2 monit
```

---

## æ­¥éª¤8: è®¾ç½®å¼€æœºè‡ªå¯

### 8.1 ä¿å­˜PM2è¿›ç¨‹åˆ—è¡¨

```bash
pm2 save
```

### 8.2 ç”Ÿæˆå¯åŠ¨è„šæœ¬

```bash
pm2 startup
```

è¿™ä¼šè¾“å‡ºä¸€ä¸ªå‘½ä»¤ï¼Œç±»ä¼¼ï¼š
```bash
sudo env PATH=$PATH:/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u trader --hp /home/trader
```

**å¤åˆ¶å¹¶æ‰§è¡Œè¿™ä¸ªå‘½ä»¤**ï¼ˆéœ€è¦rootæƒé™ï¼‰ã€‚

### 8.3 éªŒè¯å¼€æœºè‡ªå¯

```bash
# é‡å¯æœåŠ¡å™¨æµ‹è¯•
sudo reboot

# é‡å¯åæ£€æŸ¥
pm2 status
```

ç¨‹åºåº”è¯¥è‡ªåŠ¨å¯åŠ¨ã€‚

---

## æ­¥éª¤9: æ—¥å¿—ç®¡ç†

### 9.1 æŸ¥çœ‹å®æ—¶æ—¥å¿—

```bash
pm2 logs 15min-arbitrage
```

### 9.2 æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—

```bash
pm2 logs 15min-arbitrage --lines 100
```

### 9.3 æ¸…ç©ºæ—¥å¿—

```bash
pm2 flush
```

### 9.4 æ—¥å¿—è½®è½¬ï¼ˆé˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼‰

å®‰è£…pm2-logrotateï¼š

```bash
pm2 install pm2-logrotate

# é…ç½®æ—¥å¿—è½®è½¬
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
pm2 set pm2-logrotate:compress true
```

---

## æ­¥éª¤10: ç›‘æ§å’Œç»´æŠ¤

### 10.1 ç›‘æ§èµ„æºä½¿ç”¨

```bash
# å®æ—¶ç›‘æ§
pm2 monit

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
pm2 show 15min-arbitrage
```

### 10.2 æ›´æ–°ä»£ç 

```bash
cd ~/15

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœ‰æ–°ä¾èµ–ï¼‰
npm install

# é‡æ–°ç¼–è¯‘
npm run build

# é‡å¯ç¨‹åº
pm2 restart 15min-arbitrage
```

### 10.3 æ£€æŸ¥ç¨‹åºå¥åº·

```bash
# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs 15min-arbitrage --err

# æŸ¥çœ‹æœ€è¿‘çš„æ´»åŠ¨
pm2 logs 15min-arbitrage --lines 50
```

### 10.4 è®¾ç½®å®šæ—¶é‡å¯ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦æ¯å¤©é‡å¯ç¨‹åºï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©å‡Œæ™¨3ç‚¹é‡å¯ï¼‰
0 3 * * * /usr/bin/pm2 restart 15min-arbitrage
```

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: ç¨‹åºæ— æ³•å¯åŠ¨

**æ£€æŸ¥ï¼š**
```bash
# æŸ¥çœ‹PM2æ—¥å¿—
pm2 logs 15min-arbitrage --err

# æ£€æŸ¥.envæ–‡ä»¶
cat .env

# æ£€æŸ¥ç¼–è¯‘æ˜¯å¦æˆåŠŸ
ls -la dist/
```

**å¸¸è§åŸå› ï¼š**
- `.env` æ–‡ä»¶é…ç½®é”™è¯¯
- ç§é’¥æ ¼å¼ä¸æ­£ç¡®
- ä¾èµ–æœªå®‰è£…å®Œæ•´

### é—®é¢˜2: ç¨‹åºé¢‘ç¹é‡å¯

**æ£€æŸ¥ï¼š**
```bash
# æŸ¥çœ‹é‡å¯æ¬¡æ•°
pm2 show 15min-arbitrage

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs 15min-arbitrage --err --lines 100
```

**å¯èƒ½åŸå› ï¼š**
- å†…å­˜ä¸è¶³
- ç½‘ç»œè¿æ¥é—®é¢˜
- APIè°ƒç”¨å¤±è´¥

### é—®é¢˜3: æ‰¾ä¸åˆ°å¸‚åœº

**æ£€æŸ¥ï¼š**
```bash
# æŸ¥çœ‹ç¨‹åºæ—¥å¿—
pm2 logs 15min-arbitrage --lines 100

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping api.polymarket.com
```

**å¯èƒ½åŸå› ï¼š**
- ç½‘ç»œè¿æ¥é—®é¢˜
- APIæœåŠ¡ä¸å¯ç”¨
- å¸‚åœºç­›é€‰æ¡ä»¶å¤ªä¸¥æ ¼

### é—®é¢˜4: è®¢å•æäº¤å¤±è´¥

**æ£€æŸ¥ï¼š**
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs 15min-arbitrage --err

# éªŒè¯ç§é’¥å’Œä½™é¢
# éœ€è¦æ‰‹åŠ¨æ£€æŸ¥é’±åŒ…ä½™é¢
```

**å¯èƒ½åŸå› ï¼š**
- ç§é’¥é”™è¯¯
- è´¦æˆ·ä½™é¢ä¸è¶³
- Gasè´¹ä¸è¶³
- APIé™æµ

### é—®é¢˜5: PM2æ— æ³•å¼€æœºè‡ªå¯

**è§£å†³ï¼š**
```bash
# é‡æ–°ç”Ÿæˆå¯åŠ¨è„šæœ¬
pm2 unstartup
pm2 startup
# æ‰§è¡Œè¾“å‡ºçš„å‘½ä»¤
pm2 save
```

---

## å®‰å…¨å»ºè®®

1. **ä¿æŠ¤ç§é’¥**
   - ç¡®ä¿ `.env` æ–‡ä»¶æƒé™ä¸º 600
   - ä¸è¦å°†ç§é’¥æäº¤åˆ°Git
   - å®šæœŸæ£€æŸ¥æ–‡ä»¶æƒé™

2. **é˜²ç«å¢™è®¾ç½®**
   ```bash
   # åªå¼€æ”¾å¿…è¦ç«¯å£
   sudo ufw allow 22/tcp  # SSH
   sudo ufw enable
   ```

3. **å®šæœŸå¤‡ä»½**
   ```bash
   # å¤‡ä»½é…ç½®æ–‡ä»¶
   cp .env ~/backup/.env.$(date +%Y%m%d)
   ```

4. **ç›‘æ§å¼‚å¸¸**
   - å®šæœŸæ£€æŸ¥æ—¥å¿—
   - è®¾ç½®å‘Šè­¦ï¼ˆå¦‚æœå¯èƒ½ï¼‰
   - ç›‘æ§è´¦æˆ·ä½™é¢

---

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å¯åŠ¨
pm2 start ecosystem.config.js

# åœæ­¢
pm2 stop 15min-arbitrage

# é‡å¯
pm2 restart 15min-arbitrage

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs 15min-arbitrage

# æ›´æ–°ä»£ç 
cd ~/15 && git pull && npm install && npm run build && pm2 restart 15min-arbitrage
```

---

## å®Œæˆï¼

ç°åœ¨ä½ çš„15åˆ†é’Ÿå¸‚åœºå¥—åˆ©ç¨‹åºå·²ç»åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œäº†ï¼

**ä¸‹ä¸€æ­¥ï¼š**
- å®šæœŸæ£€æŸ¥æ—¥å¿—ï¼š`pm2 logs 15min-arbitrage`
- ç›‘æ§ç¨‹åºçŠ¶æ€ï¼š`pm2 monit`
- æ ¹æ®éœ€è¦è°ƒæ•´é…ç½®

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–å‚è€ƒæ•…éšœæ’æŸ¥éƒ¨åˆ†ã€‚
